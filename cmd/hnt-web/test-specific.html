<!DOCTYPE html>
<html>
<head>
    <title>Debug Specific Cases</title>
</head>
<body>
    <h1>Debug Specific Failing Cases</h1>
    <div id="output"></div>
    
    <script>
        function escapeHtml(str) {
            const div = document.createElement('div');
            div.textContent = str;
            return div.innerHTML;
        }
    </script>
    <script src="markdown-parser-improved.js?v=4"></script>
    <script>
        // Test specific failing cases
        const tests = [
            "_italic __bold__ text_",
            "***bold and italic***",
            "un*believ*able",
            "**unclosed bold",
            "*unclosed italic",
            "**bold *italic **nested** italic* bold**",
            "Text with `code` and **bold**",
            "**bold with `code` inside**"
        ];
        
        const output = document.getElementById('output');
        
        tests.forEach(test => {
            const result = renderMarkdownImproved(test);
            const div = document.createElement('div');
            div.style.margin = '20px';
            div.style.padding = '10px';
            div.style.border = '1px solid #ccc';
            
            div.innerHTML = `
                <h3>Test: <code>${escapeHtml(test)}</code></h3>
                <p>Result HTML: <code>${escapeHtml(result)}</code></p>
                <p>Rendered: ${result}</p>
            `;
            
            output.appendChild(div);
        });
    </script>
</body>
</html>