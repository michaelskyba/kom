<!DOCTYPE html>
<html>
<head>
    <title>Markdown Parser Test</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; }
        .test { margin: 20px 0; border: 1px solid #ccc; padding: 10px; }
        .input { background: #f0f0f0; padding: 5px; margin: 5px 0; }
        .output { background: #e0e0e0; padding: 5px; margin: 5px 0; }
        .expected { background: #d0ffd0; padding: 5px; margin: 5px 0; }
        .fail { background: #ffd0d0; }
    </style>
</head>
<body>
    <h1>Markdown Parser Test Cases</h1>
    <div id="tests"></div>

    <script>
        // Copy of current implementation
        function escapeHtml(str) {
            const div = document.createElement('div');
            div.textContent = str;
            return div.innerHTML;
        }

        function renderMarkdown(text) {
            let html = escapeHtml(text);
            html = html.replace(/```([\s\S]*?)```/g, "<pre><code>$1</code></pre>");
            html = html.replace(/`([^`]+)`/g, "<code>$1</code>");
            html = html.replace(/\*\*([^\*]+)\*\*/g, "<strong>$1</strong>");
            html = html.replace(/__([^_]+)__/g, "<strong>$1</strong>");
            html = html.replace(/\b\*([^\*]+)\*\b/g, "<em>$1</em>");
            html = html.replace(/\b_([^_]+)_\b/g, "<em>$1</em>");
            return html;
        }

        // Test cases showing problems
        const tests = [
            {
                name: "Simple bold",
                input: "**bold text**",
                expected: "<strong>bold text</strong>"
            },
            {
                name: "Simple italic",
                input: "*italic text*",
                expected: "<em>italic text</em>"
            },
            {
                name: "Bold with asterisk inside",
                input: "**bold * text**",
                expected: "<strong>bold * text</strong>",
                fails: true
            },
            {
                name: "Italic inside bold",
                input: "**bold *italic* text**",
                expected: "<strong>bold <em>italic</em> text</strong>",
                fails: true
            },
            {
                name: "Bold inside italic",
                input: "*italic **bold** text*",
                expected: "<em>italic <strong>bold</strong> text</em>",
                fails: true
            },
            {
                name: "Mixed markers",
                input: "**bold _italic_ text**",
                expected: "<strong>bold <em>italic</em> text</strong>",
                fails: true
            },
            {
                name: "Overlapping (invalid markdown)",
                input: "**bold *italic** text*",
                expected: "<strong>bold *italic</strong> text*",
                note: "Should handle gracefully"
            },
            {
                name: "Multiple bold sections",
                input: "**first** and **second**",
                expected: "<strong>first</strong> and <strong>second</strong>"
            },
            {
                name: "Italic inside word",
                input: "un*believ*able",
                expected: "un<em>believ</em>able",
                fails: true,
                note: "Word boundaries prevent this"
            },
            {
                name: "Complex nesting",
                input: "***bold and italic***",
                expected: "<strong><em>bold and italic</em></strong>",
                fails: true
            }
        ];

        // Run tests
        const container = document.getElementById('tests');
        tests.forEach(test => {
            const result = renderMarkdown(test.input);
            const passed = result === test.expected;
            
            const div = document.createElement('div');
            div.className = 'test' + (!passed && !test.fails ? ' fail' : '');
            div.innerHTML = `
                <h3>${test.name} ${test.fails ? '(Known to fail)' : ''}</h3>
                ${test.note ? `<p><em>Note: ${test.note}</em></p>` : ''}
                <div class="input">Input: <code>${escapeHtml(test.input)}</code></div>
                <div class="expected">Expected: <code>${escapeHtml(test.expected)}</code></div>
                <div class="output ${!passed ? 'fail' : ''}">Actual: <code>${escapeHtml(result)}</code></div>
                <div>Rendered: ${result}</div>
            `;
            container.appendChild(div);
        });
    </script>
</body>
</html>